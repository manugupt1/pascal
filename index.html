<!DOCTYPE html>
<meta charset="utf-8">
<style>


</style>

<body onLoad='draw();'>
<div>
The following visualization 
</div>

<div id="drawing" width="500" height="500" >
</div>

<br/><br/>

<div >
Select a value to adjust the triangle &nbsp;&nbsp;&nbsp;
<input list="triangle_level" value="9" onmouseup="pascal();">
<datalist id="triangle_level">
  <option value="1">
  <option value="2">
  <option value="3">
  <option value="4">
  <option value="5">
  <option value="6">
  <option value="7">
  <option value="8">
  <option value="9">
</datalist> 
<br/>
<button type="button" onclick='equation();' id="toggle_eqn_button">Show equation</button>
<button type="button" onClick='pow_2();' id="pow2">Show Powers of 2</button>
</div>

<div style="text-align:center;">
    <div style="border:1px solid #000; display:inline-block;">Div 1</div>
    <div style="border:1px solid red; display:inline-block;" id="distribution">Div 2</div>
</div>  

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/d3.hexbin.v0.min.js?5c6e4f0"></script>

<script>

	    var svg = d3.select("#drawing").append("svg")
	    .attr("width",1020).attr("height",500);
		var svg1 = d3.select("#distribution").append("svg")
				.attr("width",100).attr("height",100)
				.append("text").attr("x",10).attr("y",10)
							.attr("fill","black");


function pascal(){
	console.log(document.getElementById('triangle_level'));
}
							
var toggle_eqn_button = false;
function equation(){
	if(toggle_eqn_button){
		toggle_eqn_button=false;
		document.getElementById('toggle_eqn_button').innerHTML="Show Equation"
	}
	else{
		toggle_eqn_button = true;
		document.getElementById('toggle_eqn_button').innerHTML="Hide Equation"
	}
	draw();
}

var pow2 = false;
function pow_2(){
	if(pow2){
		pow2=false;
		document.getElementById('pow2').innerHTML="Show Powers of 2"
	}
	else{
		pow2 = true;
		document.getElementById('pow2').innerHTML="Hide Powers of 2"
	}
	draw();

}

function hex_corner(x,y,size,i){
	PI = Math.PI;
	var angle = 2*PI / 6*(i+0.5);
	var point = ((x + size * Math.cos(angle))+","+ (y+ size*Math.sin(angle)));
	//console.log(point);
	return point;
	
}

function combination(n,k){
	if (k > n) {
        return 0;
    }
    r = 1;
    for (d = 1; d <= k; ++d) {
        r *= n--;
        r /= d;
    }
	//console.log(n + "," + k + "," + r);
    return r;
}

function draw(){
		linearmap = d3.scale.pow().exponent(0.35)
		                .domain([0,50])
		                .range(['#47B8C8','#423A38'])

		
		size = 30;
		
		var points = "";
		height = size*2;
		vert = height * 3/4;
		width = Math.sqrt(3)/2 * height;
		
		console.log(points);
		
		x1 = 300;
		y1 = 50;
				
		for(a = 0;a<10;a++){
			val = 1;
			for(b=0;b<=a;b++){
				points = ""
				x = x1+width*b;
				y = y1;
				for(i=0;i<6;i++){
					points += hex_corner(x,y,size,i) + " ";
				}
				c = combination(a,b);
				hex = svg.append("polygon").transition().duration(50)
				.attr("points",points)
				.attr("fill",function(d){
					temp = linearmap(c);
					//console.log(c+"-->"+temp);
					return temp;
				});
				//hex.enter().append("svg:title").text("manu");
		
				svg.append("text").attr("x",x).attr("y",y).text(c).attr("fill","white").attr('text-anchor',"middle").attr('n',a).attr('r',b).attr('c',c)
				.on("mouseover",function(d){
					
					d3.select(this)
					.text(this.getAttribute('n')+'C'+this.getAttribute('r'));				
					
					svg1.text(this.getAttribute('n')+'C'+this.getAttribute('r'));
				})
				.on("mouseout",function(d){
					d3.select(this)
					.text(this.getAttribute('c'));
				});
			}
			if(toggle_eqn_button){
				svg.append("text").attr("x",600).attr("y",y).text("(x+1)^"+a);
			}else{
				svg.append("text").attr("x",600).attr("y",y).text("(x+1)^"+a).attr("fill","white").attr("stroke","white");
			}
			if(pow2){
				svg.append("text").attr("x",600+width*2).attr("y",y).text("2^"+a+"="+Math.pow(2,a));
			}else{
				svg.append("text").attr("x",600+width*2).attr("y",y).text("2^"+a+"="+Math.pow(2,a)).attr("fill","white").attr("stroke","white");;
			}
			
			x1 -= width *0.5;
			y1 += height*0.75;
		}
		x1 += width *0.5;
		for(i=0;i<10;i++){
			svg.append("text").attr("x",x1).attr("y",y1).attr('text-anchor',"middle").text("x^"+i);
			x1 = x1+width*0.5;
			if(i!=9)
			svg.append("text").attr("x",x1).attr("y",y1).attr('text-anchor',"middle").text("+");
			x1 = x1+width*0.5;
		}
}

</script>


</body>